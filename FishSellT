-- VARS GLOBAIS
local vu1 = getgenv()

vu1.AutoFish = false
vu1.AntiAFK = false

-- Estados de Venda
local fishes = {
    {cfg = "SellAnglerfish", name = "Anglerfish"},
    {cfg = "SellDarkSkeletalShark", name = "Dark Skeletal Shark"},
    {cfg = "SellJackOBite", name = "Jack-O'-Bite"},
    {cfg = "SellSwordfish", name = "Swordfish"},
    {cfg = "SellGoldenPolkaPuffer", name = "Golden Polka Puffer"},
    {cfg = "SellGoldenRibbonAngelfish", name = "Golden Ribbon Angelfish"},
    {cfg = "SellGoldenTigerfin", name = "Golden Tigerfin"},
    {cfg = "SellSkeletalShark", name = "Skeletal Shark"},
    {cfg = "SellCandyCornSquid", name = "Candy Corn Squid"},
    {cfg = "SellCrimsonPolkaPuffer", name = "Crimson Polka Puffer"},
    {cfg = "SellCrimsonSnapper", name = "Crimson Snapper"},
    {cfg = "SellExoticTigerfin", name = "Exotic Tigerfin"},
    {cfg = "SellFangfish", name = "Fangfish"},
    {cfg = "SellZebraRibbonAngelfish", name = "Zebra Ribbon Angelfish"},
    {cfg = "SellBlueLipGrouper", name = "Blue-Lip Grouper"}
}

for _, fish in ipairs(fishes) do vu1[fish.cfg] = false end

-- UI SETUP (Usando a biblioteca do seu arquivo x.txt)
local SimpleKavo = loadstring(game:HttpGet('https://raw.githubusercontent.com/Lktx11/fishgpo/refs/heads/main/janela'))()
local v2 = SimpleKavo.CreateLib('Raph Pesca Automatica', 'HalloweenTheme')

-- ✅ CORREÇÃO DOS MÉTODOS: AddTab e NewSection conforme o arquivo x.txt
local v3 = v2:AddTab('Main') 
local v7 = v3:NewSection('Fishing / Player')

local v8 = v2:AddTab('Sell Fish')
local v9 = v8:NewSection('Individual Sell')

-- SERVICES
local vu12 = game:GetService('Players').LocalPlayer
local vu14 = vu12:WaitForChild('PlayerGui')
local vu15 = workspace.CurrentCamera
local vu16, vu17, vu18, vu19 = false, nil, 0, tick()
local vu20 = {}
local vu21, vu22, vu23 = 0.025, 0.04, 0.003
local vu24, vu25, vu26 = false, false, nil

-- FUNÇÕES DE SUPORTE
local function vu30()
    local x, y = vu15.ViewportSize.X / 2, vu15.ViewportSize.Y / 2
    mousemoveabs(x, y); mouse1click()
end

local function SellSpecificFish(fishName)
    local remote = game:GetService("ReplicatedStorage"):FindFirstChild("FishingShopRemote")
    if remote then
        pcall(function()
            remote:InvokeServer({["Fish"] = fishName, ["All"] = false, ["Method"] = "SellFish"})
        end)
    end
end

-- LOOPS (Pesca e Venda)
task.spawn(function()
    while true do
        if vu1.AutoFish then
            local v31 = vu14:FindFirstChild('FishingUIBill')
            if v31 then
                vu24, vu25, vu26 = true, true, nil
                local v33 = v31:FindFirstChild('Frame')
                local v34, v35 = v33 and v33:FindFirstChild('Goal'), v33 and v33:FindFirstChild('Player')
                if v34 and v35 then
                    local v38 = v35.AbsolutePosition.Y + v35.AbsoluteSize.Y / 2
                    local v41 = math.max(tick() - vu19, vu23)
                    local v48 = (not vu17 and 0 or (v38 - vu17) / v41)
                    vu17, vu19 = v38, tick()
                    -- Lógica de clique simplificada para estabilidade
                    if v38 > v34.AbsolutePosition.Y then mouse1press() else mouse1release() end
                end
            else
                if vu24 and vu25 then vu25, vu26 = false, tick() end
                if vu26 and tick() - vu26 >= 10 then vu26 = nil; vu30() end
            end
        end
        task.wait(0.01)
    end
end)

task.spawn(function()
    while true do
        for _, fish in ipairs(fishes) do
            if vu1[fish.cfg] then
                task.wait(math.random(2, 4))
                SellSpecificFish(fish.name)
            end
        end
        task.wait(1)
    end
end)

-- ✅ CORREÇÃO: NewToggle é o método correto para seções no seu arquivo
v7:NewToggle('Auto Fish', 'Ativa a pesca automatica', function(v) vu1.AutoFish = v end)
v7:NewToggle('Anti-AFK', 'Evita ser kickado', function(v) vu1.AntiAFK = v end)

for _, fish in ipairs(fishes) do
    v9:NewToggle('Vender ' .. fish.name, '', function(v) vu1[fish.cfg] = v end)
end
