-- VARS GLOBAIS
local vu1 = getgenv()
vu1.AutoFish = false
vu1.AntiAFK = false

-- Lista de Peixes e Configurações de Venda
local fishes = {
    {cfg = "SellAnglerfish", name = "Anglerfish"},
    {cfg = "SellDarkSkeletalShark", name = "Dark Skeletal Shark"},
    {cfg = "SellJackOBite", name = "Jack-O'-Bite"},
    {cfg = "SellSwordfish", name = "Swordfish"},
    {cfg = "SellGoldenPolkaPuffer", name = "Golden Polka Puffer"},
    {cfg = "SellGoldenRibbonAngelfish", name = "Golden Ribbon Angelfish"},
    {cfg = "SellGoldenTigerfin", name = "Golden Tigerfin"},
    {cfg = "SellSkeletalShark", name = "Skeletal Shark"},
    {cfg = "SellCandyCornSquid", name = "Candy Corn Squid"},
    {cfg = "SellCrimsonPolkaPuffer", name = "Crimson Polka Puffer"},
    {cfg = "SellCrimsonSnapper", name = "Crimson Snapper"},
    {cfg = "SellExoticTigerfin", name = "Exotic Tigerfin"},
    {cfg = "SellFangfish", name = "Fangfish"},
    {cfg = "SellZebraRibbonAngelfish", name = "Zebra Ribbon Angelfish"},
    {cfg = "SellBlueLipGrouper", name = "Blue-Lip Grouper"}
}

-- Inicializa estados
for _, fish in ipairs(fishes) do vu1[fish.cfg] = false end

-- UI SETUP (Usando SimpleKavo do arquivo x.txt)
local SimpleKavo = loadstring(game:HttpGet('https://raw.githubusercontent.com/Lktx11/fishgpo/refs/heads/main/janela'))()
local v2 = SimpleKavo.CreateLib('Raph Pesca Automatica', 'HalloweenTheme') -- [cite: 148]

local v3 = v2:AddTab('Main') -- [cite: 168, 280]
local v7 = v3:NewSection('Fishing / Player') -- [cite: 174]

local v8 = v2:AddTab('Sell Fish') -- [cite: 168, 280]
local v9 = v8:NewSection('Individual Sell') -- [cite: 174]

-- SERVICES E LOCAL PLAYER
local lp = game:GetService('Players').LocalPlayer
local backpack = lp:WaitForChild("Backpack") -- Confirmado pelo Dex

-- FUNÇÃO DE CONTAGEM (Checa o que você realmente tem)
local function GetFishCount(fishName)
    local count = 0
    for _, item in ipairs(backpack:GetChildren()) do
        if item.Name == fishName then
            count = count + 1
        end
    end
    return count
end

-- FUNÇÃO DE VENDA
local function SellSpecificFish(fishName)
    local remote = game:GetService("ReplicatedStorage"):FindFirstChild("FishingShopRemote")
    if remote then
        pcall(function()
            remote:InvokeServer({
                ["Fish"] = fishName,
                ["All"] = false,
                ["Method"] = "SellFish"
            })
        end)
    end
end

-- LOOP DE VENDA INTELIGENTE
task.spawn(function()
    while true do
        for _, fish in ipairs(fishes) do
            if vu1[fish.cfg] then
                local quantidade = GetFishCount(fish.name)
                if quantidade > 0 then
                    task.wait(math.random(2, 4)) -- Delay humano
                    SellSpecificFish(fish.name)
                end
            end
        end
        task.wait(2)
    end
end)

-- LOOP DE PESCA (Simplificado para evitar erro de método)
task.spawn(function()
    while true do
        if vu1.AutoFish then
            local fishingUI = lp.PlayerGui:FindFirstChild('FishingUIBill')
            if fishingUI then
                -- Lógica de pesca aqui (Simulação de clique)
                mouse1press()
                task.wait(0.1)
                mouse1release()
            end
        end
        task.wait(0.5)
    end
end)

-- INTERFACE (Usando NewToggle conforme o arquivo x.txt)
v7:NewToggle('Auto Fish', 'Ativa a pesca automatica', function(v) vu1.AutoFish = v end) -- [cite: 193]
v7:NewToggle('Anti-AFK', 'Evita ser kickado', function(v) vu1.AntiAFK = v end) -- [cite: 193]

for _, fish in ipairs(fishes) do
    v9:NewToggle('Vender ' .. fish.name, 'Vende se estiver no inventario', function(v) 
        vu1[fish.cfg] = v 
    end) -- [cite: 193]
end
